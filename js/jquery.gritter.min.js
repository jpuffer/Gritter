!function(t){t.gritter={},t.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3,max_to_display:0},t.gritter.add=function(t){try{return e.addToQueue(t||{})}catch(i){var r="Gritter Error: "+i;"undefined"!=typeof console&&console.error?console.error(r,t):alert(r)}},t.gritter.remove=function(t,i){e.removeSpecific(t,i||{})},t.gritter.removeAll=function(t){e.stop(t||{})},t.gritter.pause=function(t){e.pause()},t.gritter.unpause=function(t){e.unpause()};var e={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<a class="gritter-close" href="#" tabindex="1">Close Notification</a>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none" role="alert"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',_notificaiton_queue:[],addToQueue:function(e){return"string"==typeof e&&(e={text:e}),this._item_count++,this._notificaiton_queue.push(t.extend(e,{item_number:this._item_count})),this._updateDomFromQueue(),this._item_count},_updateDomFromQueue:function(){var e=t.gritter.options.max_to_display,i=e>0;(!i||t(".gritter-item-wrapper").length<e)&&this._notificaiton_queue.length>0&&this._addToDom(this._notificaiton_queue.shift())},_addToDom:function(i){if(null===i.text)throw'You must supply "text" parameter.';this._is_setup||this._runSetup();var r=i.title,s=i.text,o=i.image||"",n=i.image_html||"",a=i.sticky||!1,_=i.class_name||t.gritter.options.class_name,u=t.gritter.options.position,c=i.time||"";this._verifyWrapper();var m=i.item_number,p=this._tpl_item;t(["before_open","after_open","before_close","after_close"]).each(function(r,s){e["_"+s+"_"+m]=t.isFunction(i[s])?i[s]:function(){}}),this._custom_timer=0,c&&(this._custom_timer=c);var d=""!=o?'<img src="'+o+'" class="gritter-image" />':"",l=""!=o||""!=n?"gritter-with-image":"gritter-without-image";if(""!==n&&(d='<div class="gritter-custom-image">'+n+"</div>"),r=r?this._str_replace("[[title]]",r,this._tpl_title):"",p=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[r,s,this._tpl_close,d,m,l,_],p),this["_before_open_"+m]()===!1)return!1;t("#gritter-notice-wrapper").addClass(u).append(p);var f=t("#gritter-item-"+m);f.fadeIn(this.fade_in_speed,function(){e["_after_open_"+m](t(this))}),a||this._setFadeTimer(f,m),t(f).bind("mouseenter mouseleave",function(i){"mouseenter"==i.type?a||e._restoreItemIfFading(t(this),m):a||e._setFadeTimer(t(this),m),e._hoverState(t(this),i.type)}),t(f).find(".gritter-close").click(function(){return e.removeSpecific(m,{},null,!0),!1})},_countRemoveWrapper:function(e,i,r){i.remove(),this["_after_close_"+e](i,r),0==t(".gritter-item-wrapper").length&&t("#gritter-notice-wrapper").remove()},_fade:function(t,i,r,s){var r=r||{},o="undefined"!=typeof r.fade?r.fade:!0,n=r.speed||this.fade_out_speed,a=s,_=this;this["_before_close_"+i](t,a),s&&t.unbind("mouseenter mouseleave"),o?t.animate({opacity:0},n,function(){t.animate({height:0},300,function(){e._countRemoveWrapper(i,t,a),_._updateDomFromQueue()})}):this._countRemoveWrapper(i,t),delete this.timers[i]},_hoverState:function(t,e){"mouseenter"==e?(t.addClass("hover"),t.find(".gritter-close").show()):(t.removeClass("hover"),t.find(".gritter-close").hide())},removeSpecific:function(e,i,r,s){r||(r=t("#gritter-item-"+e)),this._fade(r,e,i||{},s),this.timers&&this.timers[e]&&delete this.timers[e]},_restoreItemIfFading:function(t,e){this.paused||(clearTimeout(this.timers[e].timeoutId),t.stop().css({opacity:"",height:""}))},_runSetup:function(){for(opt in t.gritter.options)this[opt]=t.gritter.options[opt];this._is_setup=1},_setFadeTimer:function(t,i,r){var s=this._custom_timer?this._custom_timer:this.time;r&&(s-=r),this.timers||(this.timers={}),this.timers[i]={gritter_id:i,element:t,timeout_id:setTimeout(function(){e._fade(t,i)},s),start_time:(new Date).getTime()},this.paused&&this.pause()},stop:function(e){var i=t.isFunction(e.before_close)?e.before_close:function(){},r=t.isFunction(e.after_close)?e.after_close:function(){},s=t("#gritter-notice-wrapper");i(s),s.fadeOut(function(){t(this).remove(),r()})},pause:function(e){var i=this;i.paused=!0,i.timers&&t.each(i.timers,function(t,e){e.paused_at=(new Date).getTime()-e.start_time,clearTimeout(e.timeout_id),delete e.timeout_id})},unpause:function(e){var i=this;i.paused=!1,i.timers&&t.each(i.timers,function(t,e){e.paused_at&&i._setFadeTimer(e.element,e.gritter_id,e.paused_at)})},_str_replace:function(t,e,i,r){var s=0,o=0,n="",a="",_=0,u=0,c=[].concat(t),m=[].concat(e),p=i,d=m instanceof Array,l=p instanceof Array;for(p=[].concat(p),r&&(this.window[r]=0),s=0,_=p.length;_>s;s++)if(""!==p[s])for(o=0,u=c.length;u>o;o++)n=p[s]+"",a=d?void 0!==m[o]?m[o]:"":m[0],p[s]=n.split(c[o]).join(a),r&&p[s]!==n&&(this.window[r]+=(n.length-p[s].length)/c[o].length);return l?p:p[0]},_verifyWrapper:function(){0==t("#gritter-notice-wrapper").length&&t("body").append(this._tpl_wrap)}}}(jQuery);
